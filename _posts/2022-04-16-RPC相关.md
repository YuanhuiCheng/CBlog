### 什么是 RPC?

- 通过 rpc（远程过程调用）可以调用远程计算机上某个服务的方法，这个过程就像调用本地方法一样，并且不需要了解底层网络编程的具体细节。

### RPC 过程

- 客户端：调用远程方法的一端；
    - 以本地调用的方法调用远程服务；
- 客户端 Stub（桩）：其实是一个代理类。代理类把用户调用方法，类，方法参数等信息传递到服务端；
    - 接收到调用后负责将方法，参数等组装能够进行网络传输的消息体（序列化）：RpcRequest；
    - 找到远程服务的地址，并将信息发送到服务端；
- 网络传输：实现方式很多比如最基本的 socket 或者性能以及封装更加优秀的 netty；
- 服务端 Stub：这个类接收到客户端执行方法的请求后，去指定对应的方法然后返回结果给客户端的类；
    - 收到消息反序列化为 Java 对象，即 RpcRequest；
    - 根据 RpcRequest 中的类，方法，方法参数等信息调用本地的方法；
    - 得到方法执行结果并将组装能能够进行网络传输的消息体：RpcResponse（序列化）发送至消费方；
    - 客户端 Stub 接收到消息并将信息反序列化为 Java 对象：RpcResponse；
- 服务端：提供远程方法的一端；

### 如何设计一个 rpc 框架？

- 需要高性能网络传输，可采用 netty 实现；
- 需要自定义协议，需定义序列化协议，因为网络传输都是通过二进制流传输；
- 需要一套描述服务的语言，即 idl (interface description language)，让所有服务都用 idl 定义，再由框架转化为特定编程语言的接口，从而实现跨语言；框架上需要把上述细节对使用者进行屏蔽所以需要代理来实现；
- 需要一个监控机制，上报调用情况便于运维；